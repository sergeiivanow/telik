on:
  push:
    branches: [main]
name: Build Release apps
jobs:

  # build-android:
  #   name: Build Android App
  #   runs-on: ubuntu-latest
  #   env:
  #     STORE_PASSWORD: ${{ secrets.STORE_PASSWORD }}
  #     KEY_PASSWORD: ${{ secrets.KEY_PASSWORD }}
  #     KEY_ALIAS: ${{ secrets.KEY_ALIAS }}
  #     STORE_FILE: ../../release.jks 
      
  #   steps:
  #     - uses: actions/checkout@v1
  #     - uses: actions/setup-java@v1
  #       with:
  #         java-version: '12.x'
  #     - uses: subosito/flutter-action@v1
  #       with:
  #         flutter-version: '2.8.1'
  #     - run: flutter pub get

  #     - name: Get store file from GitHub Secrets
  #       run: echo "${{ secrets.STORE_FILE }}" | base64 -d > release.jks

  #     - name: Build
  #       run: | 
  #         flutter build apk --split-per-abi
  #         flutter build appbundle

  #     - name: Upload Artifacts
  #       uses: actions/upload-artifact@v2
  #       with:
  #         name: Artifacts
  #         path: |
  #           build/app/outputs/apk/release/*.apk
  #           build/app/outputs/bundle/release/*.aab
  #           build/ios/iphoneos/app.ipa

  build-ios:        
    name: Build iOS App
    runs-on: macos-latest
    # env:
    #   FASTLANE_ITC_TEAM_NAME: ${{ secrets.FASTLANE_ITC_TEAM_NAME }}
    #   FASTLANE_TEAM_ID: ${{ secrets.FASTLANE_TEAM_ID }}
    #   FASTLANE_USER: ${{ secrets.FASTLANE_USER }}
    #   FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD: ${{ secrets.FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD }}
    #   MATCH_PASSWORD: ${{ secrets.MATCH_PASSWORD }}

    steps: 
      - name: Set env
        run: echo "MATCH_GIT_BASIC_AUTHORIZATION=$(echo -n '${{ github.actor }}:${{ github.token }}' | base64)"" >> $GITHUB_ENV
      - name: Test
        run: echo ${{ env.MATCH_GIT_BASIC_AUTHORIZATION }}
      # - uses: actions/checkout@v2
      # - uses: subosito/flutter-action@v1
      #   with:
      #     flutter-version: '2.8.1'
      # - run: flutter pub get

      # - name: Build 
      #   run: | 
      #     flutter build ios --release --no-codesign

      # - uses: maierj/fastlane-action@v2.0.1
      #   with:
      #     lane: 'beta'
      #     subdirectory: 'ios'

      # - name: Upload Artifacts
      #   uses: actions/upload-artifact@v2
      #   with:
      #     name: Artifacts
      #     path: |
      #       ios/build